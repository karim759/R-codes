# Confidence Interval for Population Mean
set.seed(123)
sample_data <- rnorm(100, mean = 5, sd = 1)
confidence_level <- 0.95
sample_mean <- mean(sample_data)
sample_sd <- sd(sample_data)
n <- length(sample_data)
margin_error <- qt(1 - (1 - confidence_level) / 2, df = n - 1) * sample_sd / sqrt(n)
lower_bound <- sample_mean - margin_error
upper_bound <- sample_mean + margin_error
print(paste("Confidence Interval for Population Mean: (", lower_bound, ", ", upper_bound, ")"))

# Using built-in function
t_test_result <- t.test(sample_data, conf.level = confidence_level)
print(t_test_result$conf.int)

# Confidence Interval for Population Proportion
set.seed(123)
sample_data <- rbinom(100, size = 1, prob = 0.5)
sample_proportion <- mean(sample_data)
n <- length(sample_data)
confidence_level <- 0.95
margin_error <- qnorm(1 - (1 - confidence_level) / 2) * sqrt(sample_proportion * (1 - sample_proportion) / n)
lower_bound <- sample_proportion - margin_error
upper_bound <- sample_proportion + margin_error
print(paste("Confidence Interval for Population Proportion: (", lower_bound, ", ", upper_bound, ")"))

# Using built-in function
prop_test_result <- prop.test(sum(sample_data), n, conf.level = confidence_level)
print(prop_test_result$conf.int)
